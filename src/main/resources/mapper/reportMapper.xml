<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.app.pickcourse.mapper.ReportMapper">
    <insert id="saveReport">
        <selectKey keyProperty="id" resultType="long" order="BEFORE">
            SELECT SEQ_REPORT.NEXTVAL FROM DUAL
        </selectKey>
        INSERT INTO TBL_REPORT
               (ID)
        VALUES(#{id})
    </insert>

     <select id="getReportList" resultType="reportListDTO">
         SELECT
             'FEED_REPORT' AS SOURCE,
             FR.REPORT_REASON,
             FR.CREATED_DATE,
             FR.REPORTED_ID,
             FR.MEMBER_ID,
             M.MEMBER_NICKNAME
         FROM TBL_FEED_REPORT FR
         JOIN TBL_MEMBER M
             ON FR.MEMBER_ID = M.ID
         UNION ALL
         SELECT
             'REPLY_REPORT' AS SOURCE,
             RR.REPORT_REASON,
             RR.CREATED_DATE,
             RR.REPORTED_ID,
             RR.MEMBER_ID,
             M.MEMBER_NICKNAME
         FROM TBL_REPLY_REPORT RR
         JOIN TBL_MEMBER M
         ON RR.MEMBER_ID = M.ID
         ORDER BY CREATED_DATE DESC
     </select>
</mapper>